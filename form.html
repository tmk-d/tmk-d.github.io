<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Basic JSON Editor Example</title>
    <script src="jsoneditor.js"></script>
    <link rel="stylesheet" id="theme-link" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  </head>
  <body>
    <div id='editor_holder'></div>

    <script>
      // Initialize the editor with a JSON schema


      var jseditor = new JSONEditor(document.getElementById('editor_holder'),{
        schema: {
            "type": "object",
            "title": "Rekord",
            "properties": {
                "IDs": {
                    "type": "object",
                    "format": "grid",
                    "options": {"collapsed": true},
                    "properties": {
                        "ORCID": {"type": "string"},
                        "RADON ID": {"type": "string"},
                        "Ludzie Nauki ID":  {"type": "string"},
                    },
                },
                "Bio": {
                    "type": "object",
                    "options": {"collapsed": true},
                    "properties": {
                        "Imię": {
                            "type": "array",
                            "format": "table",
                            "items": {
                                "type": "string",
                                "title": "imię"
                            }
                        },
                        "Nazwisko": {
                            "type": "array",
                            "format": "table",
                            "items": {
                                "type": "string",
                                "title": "nazwisko"
                            }
                        },
                        "Data urodzenia": {
                            "type": "string"
                        },
                        "Miejsce urodzenia": {
                            "type": "string"
                        }
                    }
                },
                "Wykształcenie": {
                    "type": "array",
                    "options": {"collapsed": true},
                    "format": "table",
                    "items": {
                        "type": "object",
                        "title": "stopień/tytuł",
                        "properties": {
                            "stopień/tytuł": {
                                "type": "string",
                                "enum": ['lic.', 'mgr', 'dr', 'dr hab.', 'prof.', 'inne']
                            },
                            "uczelnia": {"type": "string"},
                            "dyscyplina": {"type": "string"},
                            "rok": {"type": "integer"}
                        }

                    }                    
                },
                "Granty (kierownik)": {
                    "type": "array",
                    "options": {"collapsed": true},
                    "format": "table",
                    "items": {
                        "type": "object",
                        "title": "grant",
                        "properties": {
                            "Grantodawca": {
                                "type": "string",
                                "enum": [
                                    "NCN",
                                    "NPRH",
                                    "Horizon/PR",
                                    "Inne polskie",
                                    "Inne zagraniczne",
                                    "Inne międzynarodowe"
                                ]
                            },
                            "Tytuł projektu": {
                                "type": "string"
                            }
                        }
                    }
                },
                "Zatrudnienie": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "type": "object",
                        "title": "zatrudnienie",
                        "properties": {
                            "uczelnia": {"type": "string"},
                            "okres": {"type": "string"},
                        }
                    }
                },
                "Funkcje akademickie": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "type": "object",
                        "title": "funkcja",
                        "properties": {
                            "Nazwa funkcji": {"type": "string"},
                            "Uczelnia / instytucja": {"type": "string"},
                            "Okres": {"type": "string"},
                        }
                    }
                },
                "Działalność pozaakademicka": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "type": "object",
                        "properties": {
                            "Pole": {
                                "type": "string",
                                "enum": ['biznes', 'NGO', 'admin. lokalne', 'admin. centralne', 'admin. międzynarodowe', 'inne'],
                            },
                            "Rodzaj": {
                                "type": "string",
                                "enum": ["pozycja", "projekt"]
                            },
                            "Opis": {"type": "string"}
                        }

                    }                    
                },
                "Wyjazdy zagraniczne": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "type": "object",
                        "title": "wyjazd",
                        "properties": {
                            "kraj": {"type": "string"},
                            "instytucja": {"type": "string"},
                            "okres": {"type": "string"}
                        }
                    }   
                },
                "Obecność w mediach": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "type": "object",
                        "properties": {
                            "tytuł": {"type": "string"},
                            "link": {"type": "string"}
                        }
                    }    
                },
                "Nagrody": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "type": "object",
                        "title": "nagroda",
                        "properties": {
                            "nagroda": {"type": "string"},
                            "typ": {
                                "type": "string",
                                "enum": ["uczelniana", "pole naukowe", "inne pola", "odznaczenie"]

                            }
                        }                    
                    },
                },
                "Źródła": {
                    "type": "array",
                    "format": "table",
                    "options": {"collapsed": true},
                    "items": {
                        "title": "źródło",
                        "type": "string"
                    }
                }
            },
            "required": []
        },
        theme: 'bootstrap4',
        disable_properties: true,
        // array_controls_top: true,
        disable_edit_json: true,
        disable_array_reorder: true,
        prompt_before_delete: false
      });

      jseditor.on('ready', function() {
        var button = jseditor.root.getButton('Save Result As File', 'save', 'Save Result As File'),
        button_holder = jseditor.root.theme.getHeaderButtonHolder();
        button_holder.appendChild(button);
        jseditor.root.header.parentNode.insertBefore(button_holder, jseditor.root.header.nextSibling);

        button.addEventListener('click', function(e) {
            e.preventDefault();
            var example = jseditor.getValue(),
            filename = 'example.json',
            blob = new Blob([JSON.stringify(example, null, 2)], {
            type: "application/json;charset=utf-8"
            });

            if (window.navigator && window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveOrOpenBlob(blob, filename);
            } else {
            var a = document.createElement('a');
            a.download = filename;
            a.href = URL.createObjectURL(blob);
            a.dataset.downloadurl = ['text/plain', a.download, a.href].join(':');

            a.dispatchEvent(new MouseEvent('click', {
                'view': window,
                'bubbles': true,
                'cancelable': false
            }));
            }
        }, false);
        });

    </script>
  </body>
</html>
